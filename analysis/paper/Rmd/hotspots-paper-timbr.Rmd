---
title: "Expression QTL hotspot dissection with mediation analysis and pleiotropy testing"
author: "Frederick J. Boehm, Brian S. Yandell, and Karl W. Broman"
date: "March 25, 2020"
bibliography: research.bib
linkReferences: true
link-citations: true 
output: 
  bookdown::html_document2: 
    code_folding: hide
    self_contained: no
    keep_md: true
  bookdown::pdf_document2:
    fig_caption: true
    keep_tex: true
---

```{r setupx, include=FALSE, dev="CairoPNG"}
.libPaths("~/work/libs")
knitr::opts_chunk$set(dev="CairoPNG")
```



```{r presetup}
eval_code <- TRUE
knitr::opts_chunk$set(comment=NA, fig.width=6, fig.height=6, eval = eval_code)
```



```{r setup}
library(qtl2hotspots)
ult <- 15 # univariate lod threshold
```

```{r load_tidyverse}
library(tidyverse)
options(tibble.print_max = 50, tibble.print_min = 20)
```



```{r readRDS}
lod_peaks <- readRDS(here::here("analysis", "data", "derived_data", "lod_peaks.rds"))
annots <- readRDS(here::here("analysis", "data", "derived_data", "annots.rds"))
expr <- readRDS(here::here("analysis", "data", "derived_data", "expr.rds"))
probs <- readRDS(here::here("analysis", "data", "derived_data", "genoprobs.rds"))
K <- readRDS(here::here("analysis", "data", "derived_data", "kinship.rds"))
covar <- readRDS(here::here("analysis", "data", "derived_data", "covar.rds"))
map <- readRDS(here::here("analysis", "data", "derived_data", "map.rds"))
```


```{r setup_continued}
hot_chr <- c(2, 5, 7, 11, 13)
hot_mid <- c(165.5, 146, 46, 71, 112.5)
keller_mediator <- c("Hnf4a", "Pdx1", "Fam83e", "Sat2", "Il6st")
inputs <- tibble(hot_chr, hot_mid, keller_mediator)
out <- pmap_dfc(inputs, .f = function(hot_chr, hot_mid, keller_mediator) knitr::knit_expand(text = readLines(here::here("analysis", "paper", "Rmd", "hotspot-one-chromosome-timbr.Rmd"))))
# note that ... argument must be a list, ie, it must be a single argument, not multiple args
```



`r if (eval_code) knitr::knit(text = out[[1]])`

`r if (eval_code) knitr::knit(text = out[[2]])`

`r if (eval_code) knitr::knit(text = out[[3]])`

`r if (eval_code) knitr::knit(text = out[[4]])`

`r if (eval_code) knitr::knit(text = out[[5]])`




# Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies:

```{r colophon, cache = FALSE, echo = TRUE, tidy.opts=list(width.cutoff=50), size = "tiny", results = "markup"}
# which R packages and versions?
devtools::session_info()
```


The current Git commit details are:

```{r git2r, cache = FALSE, echo = TRUE, eval = TRUE}
# what commit is this file at?
git2r::repository(here::here())
```




